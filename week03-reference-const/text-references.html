<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by LibreOffice - see http://cgit.freedesktop.org/libreoffice/core/tree/filter/source/xslt for the code.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">- no title specified</title><meta name="DCTERMS.title" content="" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.issued" content="2017-11-04T18:18:28.350895855" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.modified" content="2018-03-23T03:52:33.855239403" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.Heading_20_1 { font-size:150%; margin-bottom:0.0835in; margin-top:0.1665in; text-align:left ! important;font-family:Liberation Sans; writing-mode:rl-tb; margin-left:0in; margin-right:0in; text-indent:0in; font-weight:bold; }
	.P1 { font-size:10pt; text-align:center ! important; font-family:Monospace; writing-mode:rl-tb; font-style:italic; text-decoration:none ! important; }
	.P10 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P11 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P12 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P13 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P14 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P15 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P19 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P2 { font-size:12pt; text-align:center ! important; font-family:Monospace; writing-mode:rl-tb; }
	.P20 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P22 { color:#000000; font-size:12pt; font-style:normal; font-weight:normal; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0.1665in; text-align:left ! important;text-indent:0in; font-family:Monospace; writing-mode:rl-tb; }
	.P23 { color:#000000; font-size:12pt; font-style:normal; font-weight:normal; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0.1665in; text-align:left ! important;text-indent:0in; font-family:Monospace; writing-mode:rl-tb; }
	.P24 { color:#000000; font-size:12pt; font-style:normal; font-weight:normal; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0.1665in; text-align:left ! important;text-indent:0in; font-family:Monospace; writing-mode:rl-tb; }
	.P25 { color:#000000; font-size:12pt; font-style:normal; font-weight:normal; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0.1665in; text-align:left ! important;text-indent:0in; font-family:Monospace; writing-mode:rl-tb; }
	.P26 { font-size:12pt; text-align:left ! important; font-family:Courier New; writing-mode:lr-tb; }
	.P27 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important; font-family:Monospace; writing-mode:lr-tb; }
	.P28 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important; font-family:Monospace; writing-mode:lr-tb; }
	.P29 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important; font-family:Monospace; writing-mode:lr-tb; }
	.P30 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important; font-family:Monospace; writing-mode:lr-tb; }
	.P32 { font-size:12pt; text-align:left ! important;font-family:Courier New; writing-mode:rl-tb; }
	.P33 { color:#000000; font-size:12pt; font-style:normal; font-weight:normal; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0.1665in; text-align:left ! important;text-indent:0in; font-family:Monospace; writing-mode:rl-tb; }
	.P34 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P35 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P36 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P37 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P38 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P39 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P40 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; font-style:normal; }
	.P41 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; font-style:normal; }
	.P42 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P43 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P45 { color:#000000; font-size:12pt; font-style:normal; font-weight:normal; margin-bottom:0.0575in; margin-left:0in; margin-right:0in; margin-top:0in; text-align:left ! important;text-indent:0in; font-family:Monospace; writing-mode:rl-tb; }
	.P46 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P47 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P48 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P49 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P5 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P50 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P51 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P52 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P53 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P54 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P55 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important; font-family:Monospace; writing-mode:lr-tb; }
	.P56 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important; font-family:Monospace; writing-mode:lr-tb; }
	.P57 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important; font-family:Monospace; writing-mode:lr-tb; }
	.P58 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important; font-family:Monospace; writing-mode:lr-tb; }
	.P59 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P60 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P61 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P62 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P63 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P64 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P65 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P66 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P67 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P68 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P69 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P7 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P70 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P71 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P72 { font-size:12pt; line-height:120%; margin-bottom:0.0575in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P73 { font-size:150%; font-weight:bold; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; margin-top:0.1665in; text-align:left ! important;text-indent:0in; font-family:Liberation Sans; writing-mode:rl-tb; }
	.P8 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.P9 { font-size:12pt; line-height:120%; margin-bottom:0.0972in; margin-top:0in; text-align:left ! important;font-family:Monospace; writing-mode:rl-tb; }
	.Bullet_20_Symbols { font-family:OpenSymbol; }
	.T1 { font-weight:bold; }
	.T2 { font-weight:bold; }
	.T3 { font-weight:bold; }
	.T38 { font-weight:bold; }
	.T39 { font-weight:bold; }
	.T4 { font-weight:bold; }
	.T44 { color:#0000ff; }
	.T45 { color:#0000ff; }
	.T46 { color:#0000ff; }
	.T48 { color:#008000; }
	.T49 { color:#008000; }
	.T5 { font-weight:bold; }
	.T50 { color:#008000; }
	.T6 { font-weight:bold; }
	.T7 { font-weight:normal; }
	.T8 { font-weight:normal; }
	<!-- ODF styles with no properties representable as CSS -->
	.Numbering_20_Symbols .T10 .T11 .T12 .T13 .T14 .T15 .T16 .T17 .T18 .T19 .T20 .T21 .T22 .T23 .T24 .T25 .T26 .T27 .T28 .T29 .T30 .T31 .T32 .T33 .T34 .T35 .T36 .T37 .T40 .T41 .T42 .T43 .T47 .T51 .T52 .T53 .T54 .T57 .T58 .T59 .T9  { }
	</style></head><body dir="ltr" style="max-width:8.2681in;margin-top:0.7874in; margin-bottom:0.7874in; margin-left:0.7874in; margin-right:0.7874in; "><h1 class="P73"><a id="a__משתני_רפרנס_-_reference_variables"><span/></a><span class="T23">משתני </span>רפרנס<span class="T23"> - reference variables</span></h1><p class="P22">רפרנסים לעומת פוינטרים</p><p class="P7">בשפת סי<span class="T10">, כשרצינו לקבל כתובת של משתנה (למשל כדי לשלוח לפונקציה שתוכל גם לשנות אותו), הגדרנו </span><span class="T2">פוינטר</span><span class="T10"> למשתנה, למשל:</span></p><p class="P27">int num; int* pnum = &amp;num;</p><p class="P34">כדי להשתמש בפוינטר, צריך ל<span class="T12">הקדים לו כוכבית, למשל:</span></p><p class="P28">(*<span class="T14">pnum</span>) = 5;</p><p class="P35">ואם המשתנה הוא עצם או struct, צריך להשתמש בחץ, למשל:</p><p class="P28">Point <span class="T16">location; Point* plocation = &amp;location;</span></p><p class="P28"><span class="T15">plocation</span>-&gt;x = 5;<span class="T13">  // equivalent to (*plocation).x = 5;</span></p><p class="P36">בשפת ++C יש דרך נוספת <span class="T11">לקבל כתובת של משתנה - להגדיר </span><span class="T3">רפרנס</span><span class="T4"> </span><span class="T8">(reference)</span><span class="T11">:</span></p><p class="P29">int&amp; <span class="T17">rnum</span> =<span class="T17"> num</span>;</p><p class="P37">זה מאד דומה, רק שהפעם, אפשר לגשת למשתנה בלי כוכבית, למשל:</p><p class="P29"><span class="T17">rnum</span> = 5;</p><p class="P38">ובלי חץ, למשל:</p><p class="P30">Point&amp; <span class="T18">rlocation</span> = <span class="T18">location</span>;    <span class="T18">rlocation</span>.x = 5;</p><p class="P39">חוץ מצורת הגישה, ישנם שני הבדלים עיקריים בין <span class="T19">פוינטר לרפרנס: </span></p><ul><li><p class="P66" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>אפשר ליצור פוינטר בלי לאתחל אותו (או לאתחל ל-nullptr), אבל כשיוצרים רפרנס - חייבים לאתחל אותו מייד למשתנה.  זה אמור לצמצם את הסיכוי לשגיאות - כשיש לנו רפרנס, אנחנו יכולים להיות בטוחים שיש שם עצם ממשי ולא null.<span class="odfLiEnd"/> </p></li><li><p class="P67" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>אפשר לשנות פוינטר לאחר יצירתו, למשל להוסיף לו 1 (ואז הוא יצביע למקום אחר בזיכרון). אבל אי אפשר לשנות רפרנס לאחר יצירתו<span class="T20">.   גם זה אמור לצמצם את הסיכוי לשגיאות - רפרנס תמיד מצביע לאותו מקום בזיכרון ולא יכול "לנדוד" למקומות לא רצויים.</span><span class="odfLiEnd"/> </p></li></ul><p class="P43">ראו הדגמה בתיקיה <span class="T57">1</span>.</p><p class="P33">השוואה לג'אבה</p><p class="P40">בג'אבה, כל המשתנים שהם עצמים (לא פרימיטיביים), <span class="T7">הם כמעט כמו רפרנסים</span>.<span class="T21"> הם מכילים כתובת של משתנה, אפשר לגשת אליהם כמו שניגשים למשתנה עצמו - בלי כוכבית ובלי חץ, ואי-אפשר "להזיז" אותם.   </span></p><p class="P41">אבל בניגוד לרפרנסים, אפשר לאתחל אותם עם null.</p><p class="P23">שימושים</p><p class="P8">השימוש העיקרי של רפרנס <span class="T22">הוא לצורך החזרת ערכים מתוך פונקציות. לדוגמה, פונקציה כגון swap - שמחליפה בין הערכים שהיא מקבלת - צריך לכתוב עם רפרנסים.  בסי היינו כותבים את הפונקציה עם פוינטרים, אבל זה פחות נוח כי הפונקציה הקוראת צריכה להפוך את הפרמטרים לפוינטרים, והפונקציה swap עצמה צריכה לגשת אליהם בצורה שניגשים לפוינטרים. רפרנסים מאפשרים להשיג אותה מטרה בצורה יותר פשוטה וקריאה.</span></p><p class="P23">"ערך שמאלי" ו"ערך ימני" - lvalue, rvalue</p><p class="P42">אחד המושגים שמופיעים הרבה בתיעוד של ++C <span class="T24">ובהודעות-השגיאה של קומפיילרים </span>הם: lvalue, rvalue<span class="T24">.</span></p><ul><li><p class="P68" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>lvalue - <span class="T24">מציין דבר שיש לו כתובת בזיכרון, דבר שמתקיים גם אחרי שהביטוי מסתיים. למשל: משתנה, רפרנס, כוכבית-פוינטר. הוא נקרא </span><span class="T5">l</span><span class="T24">value כי יש לו </span><span class="T5">l</span><span class="T24">ocation וכי אפשר לשים אותו בצד השמאלי (</span><span class="T5">l</span><span class="T24">eft) של סימן =.</span><span class="odfLiEnd"/> </p></li><li><p class="P69" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>rvalue - מציין דבר שלא ממשיך להתקיים אחרי שהביטוי מסתיים. למשל: <span class="T25">מספר, מחרוזת קבועה, ביטוי מתמטי (x+y), קריאה לפונקציה (f(123)).  הוא נקרא </span><span class="T6">r</span><span class="T25">value כי הוא יכול להופיע רק בצד הימני (</span><span class="T6">r</span><span class="T25">ight) של סימן =.</span><span class="odfLiEnd"/> </p></li></ul><p class="P46">לדוגמה, אם כותבים <span class="T26">ביטויים כמו</span>:</p><p class="P55">7<span class="T26"> </span>=<span class="T26"> </span>a;</p><p class="P56">x+y<span class="T26"> </span>=<span class="T26"> </span>a;</p><p class="P57">f() = a;</p><p class="P47"><span class="T27">(כאשר f היא פונקציה שמחזירה int)  מקבלים הודעת שגיאה: "expression must be a modifiable lvalue</span><span class="T29">"</span><span class="T30">.</span></p><p class="P48">טוב, זה די צפוי, אבל הודעת-שגיאה עם lvalue יכול להופיע גם במקרים פחות צפויים. למשל:</p><p class="P58"><span class="T28">int&amp; </span><span class="T31">refToInt</span><span class="T28"> = </span><span class="T31">5;</span></p><p class="P58"><span class="T31">int&amp; refToInt = </span><span class="T32">x+y</span><span class="T31">;</span></p><p class="P58"><span class="T31">int&amp; refToInt = </span><span class="T33">f()</span><span class="T31">;</span></p><p class="P51"><span class="T31">ג</span><span class="T28">ם כאן נקבל הודעת שגיאה האומרת לנו שאי-אפשר לאתחל רפרנס עם דבר שהוא לא lvalue. למה? כי רפרנס אמור להצביע לעצם </span><span class="T34">ש</span><span class="T28">אפשר לשנות אותו - הוא לא יכול להצביע למספר </span><span class="T35">או לביטוי זמני.</span></p><p class="P52"><span class="T35">י</span><span class="T28">ש מקרה אחד שבו </span><span class="T36">אפשר להציב rvalue בתוך רפרנס - כאשר מגדירים את הרפרנס כקבוע - const. למשל הביטויים הבאים חוקיים:</span></p><p class="P58"><span class="T37">const </span><span class="T28">int&amp; </span><span class="T31">refToInt</span><span class="T28"> = </span><span class="T31">5;</span></p><p class="P58"><span class="T37">const </span><span class="T31">int&amp; refToInt = </span><span class="T32">x+y</span><span class="T31">;</span></p><p class="P58"><span class="T37">const </span><span class="T31">int&amp; refToInt = </span><span class="T33">f()</span><span class="T31">;</span></p><p class="P54"><span class="T31">כ</span><span class="T28">יוון שהדבר שמצביעים אליו מוגדר כ"קבוע", הקומפיילר ממילא לא ייתן לנו לשנות אותו, ולכן הרפרנס יכול להצביע גם לדבר שאין לו כתובת בזיכרון.</span></p><p class="P70">במקרה זה, הקומפיילר מאריך את אורך-החיים של המשתנה הזמני, כך שיישאר בזיכרון (בד"כ על המחסנית) למשך כל אורך החיים של הרפרנס.</p><p class="P53"><span class="T39">ל</span><span class="T38">מה צריך את זה?</span><span class="T28"> - השימוש העיקרי של const reference הוא כשרוצים להעביר ארגומנטים לפונקציות.</span><span class="T40"> זה שימושי במיוחד כשהארגומנט הוא אובייקט גדול. יש כמה דרכים להעביר אותו לפונקציה:</span></p><ul><li><p class="P72" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span><span class="T28">אם מעבירים אותו כערך - הוא </span><span class="T38">מועתק</span><span class="T28"> למשתנה זמני שמועבר לפונקציה. זה יכול להיות מאד בזבזני כשהמשתנה גדול.</span><span class="odfLiEnd"/> </p></li><li><p class="P72" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span><span class="T28">אם מעבירים אותו כרפרנס - הוא לא מועתק, רק הכתובת שלו מועתקת, </span><span class="T38">אבל</span><span class="T28">, הפונקציה יכולה לשנות את ערכו, וזה עלול לגרום שגיאות לוגיות.</span><span class="odfLiEnd"/> </p></li><li><p class="P71" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>אם מעבירים אותו כרפרנס-קבוע (const &amp;), רק הכתובת שלו מועתקת, ובנוסף, הקומפיילר מוודא שאי-אפשר לשנות את ערכו<span class="T58">.</span> יתרון נוסף הוא, שאפשר להעביר לפונקציה rvalue<span class="T58"> - למשל ערך זמני המגיע מקריאה לפונקציה קודמת.</span><span class="odfLiEnd"/> </p></li></ul><p class="P49"> </p><p class="P45">החזרת רפרנסים מתוך פונקציות</p><p class="P19">ב++C אפשר ל<span class="T59">א רק להעביר רפרנסים כפרמטרים לפונקציות, אלא גם להחזיר רפרנסים מתוך פונקציות.  </span><span class="T41">ראו הדגמה בתיקיה</span><span class="T42"> 2</span><span class="T41">.</span></p><p class="P20"><span class="T41">ל</span><span class="T28">מה זה טוב?</span></p><ol><li><p class="P59" style="margin-right:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:right;min-width:0.635cm;">1.</span>שיטה של מחלקה יכולה להחזיר רפרנס לשדה של המחלקה, כדי לאפשר לקוראים לשנות את המחלקה. לדוגמה, במחלקה המייצגת מערך של מספרים, יכולה להיות שיטה בשם "get" המקבלת אינדקס ומחזירה את המספר הנמצא באינדקס זה. בג'אבה, כדי לשנות את המספר הזה, היינו צריכים שיטה אחרת בשם "put". ב++C, אפשר לשנות את השיטה "get" כך שתחזיר int&amp; במקום int, כך נוכל להשתמש באותה שיטה לקריאה ולכתיבה.<span class="odfLiEnd"/> </p></li><li><p class="P59" style="margin-right:0cm;"><span class="Numbering_20_Symbols" style="display:block;float:right;min-width:0.635cm;">2.</span>כשכותבים שיטה שמשנה מחלקה, מקובל להחזיר רפרנס למחלקה עצמה, כדי שיהיה אפשר לקרוא לכמה שיטות-עדכון בשרשרת. ראו דוגמה בתיקיה 2.<span class="odfLiEnd"/> </p></li></ol><p class="P50"> </p><p class="P50"> </p><h1 class="Heading_20_1"><a id="a__קבועים_-_const"><span/></a>קבועים - const</h1><p class="P9">המילה const קיימת גם בשפת סי. <span class="T43">אם שמים אותה מייד לפני שם של משתנה - המשתנה יהיה קבוע, והקומפיילר לא ייתן לנו לשנות אותו.  עד כאן זה פשוט.</span></p><p class="P10">כשיש פוינטרים זה קצת יותר מסובך - צריך לשים לב מי הקבוע - הפוינטר או הדבר שהוא מצביע עליו? </p><p class="P26"><span class="T45">int</span><span class="T47"> *</span><span class="T45">const</span><span class="T47"> p1 = &amp;i; </span><span class="T49">// a const </span><span class="T48">pointer to an un-const variable </span></p><p class="P26">p1++; <span class="T51">   </span><span class="T48">// c</span><span class="T50">ompiler </span><span class="T48">error </span></p><p class="P26">(*p1)++; <span class="T48">// ok </span></p><p class="P26"><span class="T46">const </span><span class="T44">int</span>* p2 = &amp;b; <span class="T48">// an un-const pointer to a const variable </span></p><p class="P26">p2++; <span class="T51">    </span><span class="T48">// ok</span></p><p class="P26">(*p2)++; <span class="T51"> </span><span class="T48">// c</span><span class="T50">ompiler </span><span class="T48">error </span></p><p class="P26"><span class="T44">const</span> <span class="T44">int</span> * <span class="T44">const</span> p3 = &amp;b; <span class="T48">// a const pointer to a const variable </span></p><p class="P32"> </p><p class="P11">כשיש מחלקות ועצמים, המצב מסתבך עוד יותר. אפשר לשים את המילה const בכותרת של שיטה, אחרי הסוגריים. המשמעות היא, שבתוך השיטה הזאת, המשתנה this יהיה מצביע לעצם קבוע. במילים אחרות: השיטה לא תוכל לשנות את השדות של העצם. </p><p class="P11"><span class="T1">למה זה חשוב</span>? </p><ul><li><p class="P61" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>זה עוזר לאתר באגים ותקלות. אם שיטה מסויימת מוגדרת כ-const, אפשר להיות בטוחים שהיא לא משנה את העצם, ולכן אם העצם משתנה כנראה התקלה במקום אחר.<span class="odfLiEnd"/> </p></li><li><p class="P62" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>אם בתוכנית הראשית מגדירים עצם כ-const, אפשר לקרוא על העצם הזה רק לשיטות שהוגדרו כ-const. <span class="odfLiEnd"/> </p></li></ul><p class="P12"><span class="T1">למה זה קשה</span>? כי כששיטה היא const, הקומפיילר לא ייתן לנו לקרוא מתוכה לשיטות אחרות שהן לא const<span class="T52">!   </span>לכן, כשמגדירים שיטה כ-const עלולה להיווצר "תגובת שרשרת" שתדרוש מאיתנו הרבה שינויים בקוד.   <span class="T53">לכן עדיף מלכתחילה להגדיר כ-const כל שיטה שאנחנו יודעים שלא תצטרך לשנות את העצם.</span></p><p class="P25">קבועים והעמסה</p><p class="P13">כשמוסיפים את המילה const לשיטה, היא הופכת לחלק מה"חתימה" של השיטה. מכאן שאפשר ליצור שתי שיטות שונות עם אותו שם ואותם פרמטרים - אחת עם const ואחת בלי. הקומפיילר ישתמש בשיטה הנכונה לפי ההקשר - אם משתמשים בשיטה כ-lvalue הוא יקרא לשיטה בלי ה-const, ואם משתמשים בשיטה כ-rvalue הוא יקרה לשיטה עם ה-const.</p><p class="P13"><span class="T1">מתי זה שימושי</span>? למשל, כשמגדירים מבנה-נתונים של וקטור. למבנה יש שיטה get(i) שמחזירה את האלמנט במקום i. מקובל ליצור שתי שיטות עם <span class="T1">מימוש זהה</span>:</p><ul><li><p class="P63" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>אחת מיועדת לקריאה - היא <span class="T54">מוגדרת כ-const ומחזירה const&amp;</span>.<span class="odfLiEnd"/> </p></li><li><p class="P63" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>השניה מיועדת לכתיבה - היא מוגדרת בלי const ומחזירה &amp;.<span class="odfLiEnd"/> </p></li></ul><p class="P14">הקומפיילר יחליט לאיזו שיטה לקרוא, לפי סוג המשתנה: אם המשתנה הוא const הוא יקרא לשיטה המיועדת לקריאה בלבד; אחרת הוא יקרא לשיטה המיועדת לכתיבה.</p><p class="P24">שדה mutable</p><p class="P15">לפעמים רוצים לשמור בתוך עצם, שדה מסויים שהערך שלו לא משקף את המצב של העצם. לדוגמה, זה יכול להיות cache של תוצאת-ביניים של חישוב כלשהו. החישוב לא משנה את מצב העצם, אבל הוא צריך לשמור את התוצאה ב-cache.  </p><p class="P15">כדי שהקומפיילר יאפשר לנו לעשות זאת, נסמן את ה-cache ב-mutable. </p><p class="P15">שדה המסומן ב-mutable ניתן לשינוי גם אם העצם הוא const.</p><p class="P60"> </p><p class="P25">מקורות</p><ul><li><p class="P64" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>מצגות של<span class="T9"> </span>אופיר פלא ומירי בן-ניסן.<span class="odfLiEnd"/> </p></li><li><p class="P65" style="margin-right:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:right;min-width:0.635cm;">•</span>https://eli.thegreenplace.net/2011/12/15/understanding-lvalues-and-rvalues-in-c-and-c<span class="odfLiEnd"/> </p></li></ul><p class="P5"> </p><p class="P5">סיכם: אראל סגל-הלוי.</p><p class="P5"> </p></body></html>